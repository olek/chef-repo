#!/bin/bash

set -e

VERSION_DOTS="3.4.10"
VERSION_ZEROS="030410"
VERSION_SHORT="$VERSION_DOTS"
VERSION_LONG="$VERSION_DOTS-$VERSION_ZEROS"
TIMESTAMP="201208270554"
ARCH="amd64"

UNINSTALL="$1"

if [[ $UNINSTALL == "false" ]]; then
  echo "Uninstalling ..."
  dpkg --purge linux-headers-${VERSION_DOTS}-${VERSION_ZEROS}-generic
  dpkg --purge linux-headers-${VERSION_DOTS}-${VERSION_ZEROS}
  dpkg --purge linux-image-extra-${VERSION_DOTS}-${VERSION_ZEROS}-generic
  dpkg --purge linux-image-${VERSION_DOTS}-${VERSION_ZEROS}-generic
else
  echo "Installing ..."

  link1="http://kernel.ubuntu.com/~kernel-ppa/mainline/v${VERSION_SHORT}-quantal/linux-headers-${VERSION_LONG}_${VERSION_LONG}.${TIMESTAMP}_all.deb"
  url1="http://kernel.ubuntu.com/~kernel-ppa/mainline/v${VERSION_SHORT}-quantal/linux-headers-${VERSION_LONG}-generic_${VERSION_LONG}.${TIMESTAMP}_${ARCH}.deb"
  url2="http://kernel.ubuntu.com/~kernel-ppa/mainline/v${VERSION_SHORT}-quantal/linux-image-${VERSION_LONG}-generic_${VERSION_LONG}.${TIMESTAMP}_${ARCH}.deb"
  url3="http://kernel.ubuntu.com/~kernel-ppa/mainline/v${VERSION_SHORT}-quantal/linux-image-extra-${VERSION_LONG}-generic_${VERSION_LONG}.${TIMESTAMP}_${ARCH}.deb"

  TMP_DIR=$HOME/install/kernel${VERSION_SHORT}-${ARCH}
  mkdir $TMP_DIR

  sudo rm -rf $TMP_DIR/*

  cd $TMP_DIR

  wget $link1
  wget $url1
  wget $url2
  wget $url3

  sudo dpkg -i *.deb  

  #sudo rm -rf $TMP_DIR
fi
